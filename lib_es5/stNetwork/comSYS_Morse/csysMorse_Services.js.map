{"version":3,"sources":["stNetwork/comSYS_Morse/csysMorse_Services.js"],"names":[],"mappings":"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","file":"stNetwork/comSYS_Morse/csysMorse_Services.js","sourcesContent":["\"use strict\";\r\n\r\n/**\r\n * COMSystem library\r\n * \r\n * Provides communications system to ST network\r\n * \r\n * \r\n * v. Morse\r\n * \r\n */\r\n\r\n/**\r\n * Import TBind_Morse\r\n * @ignore\r\n */\r\nlet TBind_Morse = require(\"./COMsys_Morse.js\").TBind_Morse;\r\n\r\n\r\n/**\r\n * Bind Service\r\n * \r\n * \r\n * @class\r\n * @memberof st.net.comsys_morse\r\n * \r\n * @property {object} comSYS - The COMSystem.\r\n * @property {object} tBind - The TBind.\r\n * \r\n */\r\nclass TBind_Morse_Service {\r\n\t\r\n\t/**\r\n\t * \r\n\t * @param {COMSystem} comSYS - COM System\r\n\t * @param {object} tBind - TBinds service\r\n\t * @constructs TBind_Morse_Service\r\n\t */\r\n\tconstructor(comSYS, tBind) {\r\n\t\t\r\n\t\tthis.comSYS = comSYS;\r\n\t\tthis.tBind = tBind;\r\n\t\tthis.CONSTANTS = comSYS.CONSTANTS;\r\n\t}\r\n\t\r\n\t/**\r\n\t * Initialize TBind_Morse_Service\r\n\t */\r\n\tinitialize() {\r\n\t\t\r\n\t\tlet service = this;\r\n\t\tservice.mapControlEvents();\r\n\t}\r\n\t\r\n\t\r\n\t/**\r\n\t * Map control events\r\n\t */\r\n\tmapControlEvents() {\r\n\t\t\r\n\t\tlet service = this;\r\n\t\tlet tBind = service.tBind;\r\n\t\t\r\n\t\tlet comSYS = service.comSYS;\r\n\t\tlet _config = comSYS.config;\r\n\t\t\r\n\t\tlet socket = _config.controlChannel.socket;\r\n\t\t\r\n\t\t// Map event Unbind\r\n\t\ttBind.eventEmitter.on(tBind.CONSTANTS.Events.Unbind, service._event_Unbind);\r\n\t\t\r\n\t\t// Map event Bind_Started\r\n\t\ttBind.eventEmitter.on(tBind.CONSTANTS.Events.Bind_Started, service._event_Bind_Started);\r\n\t}\r\n\t\r\n\t\r\n\t/**\r\n\t * Event Bind_Started\r\n\t */\r\n\t_event_Bind_Started(data) {\r\n\t\t\r\n\t\tlet service = this;\r\n\t\tlet tBind = service.tBind;\r\n\t\t\r\n\t\tlet comSYS = service.comSYS;\r\n\t\tlet _config = comSYS.config;\r\n\t\t\r\n\t\tlet socket = _config.controlChannel.socket;\r\n\t\t\r\n\t\tlet synchro = data.synchro;\r\n\t\tlet options = data.options;\r\n\t\t\r\n\t}\r\n\t\r\n\t\r\n\t/**\r\n\t * Event Unbind\r\n\t */\r\n\t_event_Unbind(data) {\t\r\n\t\t\r\n\t}\r\n\t\r\n}\r\n\r\n\r\n/**\r\n * Communications System Service\r\n * \r\n * @class\r\n * @memberof st.net.comsys_morse\r\n * \r\n */\r\nclass COMSys_Morse_Service {\r\n\t\r\n\t/**\r\n\t * @construct COMSys_Morse_Service\r\n\t */\r\n\tconstructor(comSYS) {\r\n\t\t\r\n\t\tthis.comSYS = comSYS;\r\n\t\tthis.CONSTANTS = comSYS.CONSTANTS;\r\n\t}\r\n\t\r\n\t/**\r\n\t * Initialize\r\n\t */\r\n\tinitialize() {\r\n\t\t\r\n\t\tlet service = this;\r\n\t\tservice.mapControlEvents();\r\n\t\tservice.mapControlMessages();\r\n\t}\r\n\t\r\n\t\r\n\t/**\r\n\t * Map control events\r\n\t */\r\n\tmapControlEvents(socket) {\r\n\t\t\r\n\t\tlet service = this;\r\n\t\t\r\n\t\tlet comSYS = service.comSYS;\r\n\t\tlet _config = comSYS.config;\r\n\t\t\r\n\t\t\r\n\t\tif (socket === undefined) {\r\n\t\t\tsocket = _config.controlChannel.socket;\r\n\t\t}\r\n\t\t\r\n\t\t// Map event Bind_Added\r\n\t\tcomSYS.eventEmitter.on(comSYS.CONSTANTS.Events.Bind_Added, service._event_Bind_Added);\r\n\t\t\r\n\t}\r\n\t\r\n\t\r\n\t/**\r\n\t * Map control messages\r\n\t */\r\n\tmapControlMessages(socket) {\r\n\t\t\r\n\t\tlet service = this;\r\n\t\t\r\n\t\tlet comSYS = service.comSYS;\r\n\t\tlet _config = comSYS.config;\r\n\t\t\r\n\t\tif (socket === undefined) {\r\n\t\t\tsocket = _config.controlChannel.socket;\r\n\t\t}\r\n\t\t\r\n\t\t\r\n\t\t// Map message getBindList\r\n\t\tsocket.on(comSYS.CONSTANTS.Messages.getBindList, function(msg){\r\n\t\t\tservice._msg_getBindList(msg, socket, {\r\n\t\t\t\t\"filter\" : msg.filter\r\n\t\t\t});\r\n\t\t  });\r\n\t\t\r\n\t\t\r\n\t\t// Map message ErrorInfo\r\n\t\tsocket.on(comSYS.CONSTANTS.Messages.ErrorInfo, function(msg){\r\n\t\t\tservice._msg_ErrorInfo(msg, socket, {\r\n\t\t\t\t\"msgError\" : msg\r\n\t\t\t});\r\n\t\t  });\r\n\t\t\r\n\t}\r\n\t\r\n\t\r\n\t/**\r\n\t * Send ErrorInfo message\r\n\t */\r\n\tsendErrorInfo(socket, context, msg, data) {\r\n\t\t\r\n\t\tlet service = this;\r\n\t\t\r\n\t\tlet comSYS = service.comSYS;\r\n\t\tlet _config = comSYS.config;\r\n\t\t\r\n//\t\tlet socket = _config.controlChannel.socket;\r\n\t\t\r\n\t\t\t\r\n\t\tlet message = {\r\n\t\t\t\"context\" : context,\r\n\t\t\t\"msg\": msg,\r\n\t\t\t\"data\": data\r\n\t\t};\r\n\t\t\r\n\t\tsocket.emit(service.CONSTANTS.Messages.ErrorInfo, message);\t// Emit message BindList\r\n\t\t\r\n\t}\r\n\t\r\n\t\r\n\t/**\r\n\t * Event Bind_Added\r\n\t */\r\n\t_event_Bind_Added(data) {\r\n\t\t\r\n\t}\r\n\t\r\n\t\r\n\t/**\r\n\t * Message ErrorInfo\r\n\t */\r\n\t_msg_ErrorInfo(msg, socket, options) {\r\n\t\t\r\n\t\tconsole.log('<*> ST COMSys_Morse_Service._msg_ErrorInfo');\t// TODO REMOVE DEBUG LOG\r\n\t\tconsole.log(msg);\r\n\t\t\r\n\t}\r\n\t\r\n\t\r\n\t/**\r\n\t * Message getBindList\r\n\t */\r\n\t_msg_getBindList(msg, socket, options) {\r\n\t\t\r\n\t\tlet service = this;\r\n\t\t\r\n\t\tlet comSYS = service.comSYS;\r\n\t\tlet _config = comSYS.config;\r\n\t\t\r\n\t\tconsole.log('<*> ST COMSys_Morse_Service._msg_getBindList');\t// TODO REMOVE DEBUG LOG\r\n\t\t\r\n\t\tlet message = {\r\n\t\t\t\"bindsList\": [],\r\n\t\t\t\"binds\" : comSYS.thingsBindings.length\r\n\t\t};\r\n\t\t\r\n\t\tcomSYS.thingsBindings.forEach(function(_bind, _i) {\r\n\t\t\t\r\n\t\t\tlet bindInfo = {\r\n\t\t\t\t\"bindID\" : \t_bind.bindID,\r\n\t\t\t\t\"type\" : _bind.type,\r\n\t\t\t\t\"state\" : _bind.state\r\n\t\t\t};\r\n\t\t\t\r\n\t\t\tmessage.bindsList.push(bindInfo);\r\n\t\t});\r\n\t\t\r\n\t\tsocket.emit(service.CONSTANTS.Messages.BindList, message);\t// Emit message BindList\r\n\t\t\r\n\t}\r\n\t\r\n}\r\n\r\n\r\n\r\nlet cysMorseSrv_Lib = {\r\n\t\"TBind_Morse_Service\" : TBind_Morse_Service,\r\n\t\"COMSys_Morse_Service\" : COMSys_Morse_Service\r\n};\r\n\r\n\r\nmodule.exports = cysMorseSrv_Lib;\r\n\r\n"],"sourceRoot":"C:\\Users\\Felipe\\Documents\\Work\\SomeThings\\dev\\NLVL_STNetwork\\es6"}