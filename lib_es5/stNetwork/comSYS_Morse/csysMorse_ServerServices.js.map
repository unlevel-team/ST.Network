{"version":3,"sources":["stNetwork/comSYS_Morse/csysMorse_ServerServices.js"],"names":[],"mappings":"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","file":"stNetwork/comSYS_Morse/csysMorse_ServerServices.js","sourcesContent":["\"use strict\";\r\n\r\n/**\r\n * COMSystem library\r\n * for role Server\r\n * \r\n * Provides communications system to ST network\r\n * \r\n * \r\n * v. Morse\r\n */\r\n\r\n\r\nlet TBind_Morse_Server = require('./csysMorse_Server.js').TBind_Morse_Server;\r\n\r\nlet TBind_Morse_Service = require('./csysMorse_Services.js').TBind_Morse_Service;\r\nlet COMSys_Morse_Service = require('./csysMorse_Services.js').COMSys_Morse_Service;\r\n\r\n\r\n\r\n\r\n/**\r\n * Bind Service\r\n * Role Server\r\n */\r\nclass TBind_Morse_Srv_Server extends TBind_Morse_Service {\r\n\t\r\n\tconstructor(comSYS, tBind) {\r\n\t\t\r\n\t\tsuper(comSYS, tBind);\r\n\t}\r\n\t\r\n\t\r\n\t/**\r\n\t * Event Unbind\r\n\t */\r\n\t_event_Unbind(data) {\r\n\t\t\r\n\t\tlet service = this;\r\n\t\tlet tBind = service.tBind;\r\n\t\t\r\n\t\tlet comSYS = service.comSYS;\r\n\t\tlet _config = comSYS.config;\r\n\t\t\r\n\t\tlet socket = _config.controlChannel.socket;\r\n\t\t\r\n\t\tlet synchro = data.synchro;\r\n\t\tlet options = data.options;\r\n\t\t\r\n\t\tif (synchro) {\r\n\t\t\t\r\n\t\t\t// Send Message UnBind\r\n\t\t\tsocket.emit(comSYS.CONSTANTS.Messages.UnBind, \r\n\t\t\t\t{\r\n\t\t\t\t\t\"bindID\" : options.bindID\r\n\t\t\t\t}\r\n\t\t\t);\r\n\t\t}\r\n\t\t\r\n\t}\r\n\t\r\n\t\r\n}\r\n\r\n\r\n\r\n/**\r\n * Communications System Service\r\n * Role Server\r\n */\r\nclass COMSys_Morse_Srv_Server extends COMSys_Morse_Service {\r\n\t\r\n\tconstructor(comSYS) {\r\n\t\t\r\n\t\tsuper(comSYS);\r\n\t}\r\n\t\r\n\t\r\n\t/**\r\n\t * Map control messages\r\n\t */\r\n\tmapControlMessages(socket) {\r\n\t\t\r\n\t\tsuper.mapControlMessages(socket);\r\n\t\t\r\n\t\tlet service = this;\r\n\t\t\r\n\t\tlet comSYS = service.comSYS;\r\n\t\tlet _config = comSYS.config;\r\n\t\t\r\n\t\tif (socket === undefined) {\r\n\t\t\tsocket = _config.controlChannel.socket;\r\n\t\t}\r\n\r\n\t\t\r\n\t\t// Map message Bind_Created\r\n\t\tsocket.on(comSYS.CONSTANTS.Messages.Bind_Created, function(msg){\r\n\t\t\tservice._msg_Bind_Created(msg, socket, {\r\n\t\t\t\t\"bindID\" : msg.bindID,\r\n\t\t\t\t\"type\" : msg.type,\r\n\t\t\t\t\"source\" :  msg.source,\r\n\t\t\t\t\"target\" :  msg.target\r\n\t\t\t\t\r\n\t\t\t});\r\n\t\t});\r\n\t\t\r\n\t\t\r\n\t}\r\n\t\r\n\t\r\n\t/**\r\n\t * Event Bind_Added\r\n\t */\r\n\t_event_Bind_Added(data) {\r\n\t\t\r\n\t\tlet service = this;\r\n\t\t\r\n\t\tlet comSYS = service.comSYS;\r\n\t\tlet _config = comSYS.config;\r\n\t\t\r\n\t\tlet socket = _config.controlChannel.socket;\r\n\t\t\r\n\t\tlet synchro = data.synchro;\r\n\t\tlet bind = data.bind;\r\n\t\tlet options = data.options;\r\n\t\t\r\n\t\tif (synchro) {\r\n\t\t\t\r\n\t\t\t// Send Message createBind\r\n\t\t\tsocket.emit(comSYS.CONSTANTS.Messages.createBind, \r\n\t\t\t\t{\r\n\t\t\t\t\t\"bindID\" : options.bindID,\r\n\t\t\t\t\t\"type\" : options.type,\r\n\t\t\t\t\t\"source\" : options.source,\r\n\t\t\t\t\t\"target\" : options.target\r\n\t\t\t\t}\r\n\t\t\t);\r\n\t\t}\r\n\t\t\r\n\t}\r\n\t\r\n\t\r\n\t/**\r\n\t * Message Bind_Created\r\n\t */\r\n\t_msg_Bind_Created(msg, socket, options) {\r\n\t\t\r\n\t\tlet service = this;\r\n\t\t\r\n\t\tlet comSYS = service.comSYS;\r\n\t\tlet _config = comSYS.config;\r\n\t\t\r\n\t\tlet type = options.type;\r\n\t\tlet source = options.source;\r\n\t\tlet target = options.target;\r\n\t\tlet _options = {\r\n\t\t\t\"bindID\" : options.bindID\r\n\t\t};\r\n\r\n\t\tlet bindID = options.bindID;\r\n\t\t\r\n\t\tconsole.log('<*> ST COMSys_Morse_Service._msg_Bind_Created');\t// TODO REMOVE DEBUG LOG\r\n\r\n\t\t\r\n\t\ttry {\r\n\t\t\t\r\n\t\t\tlet tbindSearch = comSYS.getBindByID(bindID);\r\n\t\t\tif (tbindSearch.tbind === null) {\r\n\t\t\t\tthrow \"Bind not found.\";\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tlet tbind = tbindSearch.tbind;\r\n\t\t\t\r\n//\t\t\ttbind.initialize();\r\n//\t\t\tcomSYS.addBind(tbind);\r\n\t\t} catch (e) {\r\n\t\t\t\r\n\t\t\tconsole.log('<EEE> ST COMSys_Morse_Service._msg_createBind');\t// TODO REMOVE DEBUG LOG\r\n\t\t\tconsole.log(e);\t// TODO REMOVE DEBUG LOG\r\n\t\t\t\r\n\t\t\t// Notify Error\r\n\t\t\tservice.sendErrorInfo( socket, \"Net.Bind\", e, \r\n\t\t\t\t{ \r\n\t\t\t\t\t\"controlMSG\": comSYS.CONSTANTS.Messages.Bind_Created, \r\n\t\t\t\t\t\"msg\": msg, \r\n\t\t\t\t\t\"options\": options \r\n\t\t\t\t}\r\n\t\t\t);\r\n\t\t\t\r\n\t\t}\r\n\t\t\r\n\t} \r\n\t\r\n}\r\n\r\n\r\n\r\n\r\nlet cysMorseSrv_Server_Lib = {\r\n\t\t\"TBind_Morse_Srv_Server\" : TBind_Morse_Srv_Server,\r\n\t\t\"COMSys_Morse_Srv_Server\" : COMSys_Morse_Srv_Server\r\n\t};\r\n\r\n\r\nmodule.exports = cysMorseSrv_Server_Lib;\r\n\t\r\n"],"sourceRoot":"C:\\Users\\Felipe\\Documents\\Work\\SomeThings\\dev\\NLVL_STNetwork\\es6"}